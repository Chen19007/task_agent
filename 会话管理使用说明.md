# task-agent 会话管理功能

## 新增功能

### 命令
- /list - 列出所有保存的会话
- /new - 创建新会话（自动保存当前会话）
- /resume <id> - 恢复指定会话

### 自动保存
- 每次任务执行后自动保存当前会话
- 退出时自动保存

## 使用示例

`ash
task-agent

[user]请输入任务（q退出）：分析项目结构
... Agent 执行中 ...
# 会话已自动保存为 1

[user]请输入任务（q退出）：/new
✓ 新会话已创建: 2

[user]请输入任务（q退出）：/list

保存的会话：
  会话 1: 2025-01-15T10:30:00 | 消息数: 15 | 深度: 0
  会话 2: 2025-01-15T10:35:00 | 消息数: 2 | 深度: 0

[user]请输入任务（q退出）：/resume 1
✓ 会话已恢复: 1
`

## 技术细节

### 会话ID
- 数字ID，范围 1-1000
- 自动分配最小可用ID

### 保存内容
- 完整的 Agent 栈（context_stack）
- 当前 Agent 状态
- 全局子 Agent 计数
- 不保存 config（允许跨模型使用）

### 存储位置
- Windows: C:\Users\<用户名>\.task-agent\sessions\
- 格式: JSON

## 注意事项

- 会话ID为1-1000循环使用
- /new 会自动保存当前会话
- 可以在不同模型间恢复会话
